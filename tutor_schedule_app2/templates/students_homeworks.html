{% extends "base.html" %}

{% block title %}–î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è {{ student.full_name }} - TutorApp{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>üìö –î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è: {{ student.full_name }}</h2>
        <div class="header-actions">
            <a href="{{ url_for('view_student_card', student_id=student.id) }}" class="btn btn-secondary">
                ‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ä—Ç–æ—á–∫–µ —Å—Ç—É–¥–µ–Ω—Ç–∞
            </a>
        </div>
    </div>
    
    {% if homeworks %}
        {% for hw in homeworks %}
        <div class="homework-card tutor-view">
            <div class="homework-header">
                <h3>üìù {{ hw.description }}</h3>
                <div class="homework-status">
                    {% if hw.is_confirmed_by_tutor %}
                        <span class="status-badge status-completed">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</span>
                    {% elif hw.submitted_date %}
                        <span class="status-badge status-pending">‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</span>
                    {% elif hw.is_completed %}
                        <span class="status-badge status-completed">‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
                    {% else %}
                        <span class="status-badge status-scheduled">üìã –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="homework-details">
                {% if hw.lesson %}
                <p><strong>üìÖ –£—Ä–æ–∫ –æ—Ç:</strong> {{ hw.lesson.date_time.strftime('%d.%m.%Y %H:%M') }}</p>
                {% endif %}
                
                {% if hw.due_date %}
                <p><strong>‚è∞ –°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</strong> {{ hw.due_date.strftime('%d.%m.%Y') }}</p>
                {% endif %}
                
                {% if hw.submitted_date %}
                <p><strong>üì§ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–º:</strong> {{ hw.submitted_date.strftime('%d.%m.%Y %H:%M') }}</p>
                {% endif %}
                
                {% if hw.completed_date %}
                <p><strong>‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:</strong> {{ hw.completed_date.strftime('%d.%m.%Y %H:%M') }}</p>
                {% endif %}
                
                {% if hw.student_comment %}
                <div class="student-comment">
                    <strong>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞:</strong>
                    <p>{{ hw.student_comment }}</p>
                </div>
                {% endif %}
            </div>
            
            <div class="homework-actions">
                {% if hw.submitted_date and not hw.is_confirmed_by_tutor %}
                    <a href="{{ url_for('confirm_homework_tutor', homework_id=hw.id) }}" 
                       class="btn btn-primary" onclick="return confirm('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è?')">
                        ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
                    </a>
                    <a href="{{ url_for('mark_homework_incomplete', homework_id=hw.id) }}" 
                       class="btn btn-warning" onclick="return confirm('–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ?')">
                        ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                    </a>
                {% elif not hw.is_completed %}
                    <a href="{{ url_for('mark_homework_completed_web', homework_id=hw.id) }}" 
                       class="btn btn-success" onclick="return confirm('–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏?')">
                        ‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º
                    </a>
                    <a href="{{ url_for('mark_homework_incomplete', homework_id=hw.id) }}" 
                       class="btn btn-warning" onclick="return confirm('–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ?')">
                        ‚ùå –û—Ç–º–µ—Ç–∏—Ç—å –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º
                    </a>
                {% elif hw.is_confirmed_by_tutor %}
                    <span class="text-success">‚úÖ –ó–∞–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</span>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    {% else %}
    <div class="alert alert-info">
        üìö –£ —ç—Ç–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π.
    </div>
    {% endif %}
</div>

<style>
.homework-card.tutor-view {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    margin-bottom: 1.5rem;
    background: white;
    overflow: hidden;
}

.homework-card.tutor-view .homework-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background: var(--secondary-color);
    border-bottom: 1px solid var(--border-color);
}

.homework-card.tutor-view .homework-header h3 {
    margin: 0;
    color: var(--text-primary);
}

.homework-card.tutor-view .homework-details {
    padding: 1.5rem;
}

.homework-card.tutor-view .homework-details p {
    margin: 0.5rem 0;
}

.homework-card.tutor-view .student-comment {
    background: #e3f2fd;
    padding: 1rem;
    border-radius: var(--radius-sm);
    margin-top: 1rem;
    border-left: 4px solid #2196f3;
}

.homework-card.tutor-view .student-comment p {
    margin: 0.5rem 0 0 0;
    white-space: pre-wrap;
    font-style: italic;
}

.homework-card.tutor-view .homework-actions {
    padding: 0 1.5rem 1.5rem;
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.header-actions {
    display: flex;
    gap: 0.5rem;
}

.status-pending {
    background: #ff9800;
    color: white;
}

.text-success {
    color: #28a745 !important;
    font-weight: bold;
}
</style>
{% endblock %}