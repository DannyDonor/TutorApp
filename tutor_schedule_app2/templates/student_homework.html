{% extends "base.html" %}

{% block title %}–î–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è - TutorApp{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>üìö –ú–æ–∏ –¥–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</h2>
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–∏–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏</p>
    </div>
    
    {% if homeworks %}
        {% for homework in homeworks %}
        <div class="homework-card">
            <div class="homework-header">
                <h3>üìù {{ homework.description }}</h3>
                <div class="homework-status">
                    {% if homework.is_confirmed_by_tutor %}
                        <span class="status-badge status-completed">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</span>
                    {% elif homework.submitted_date %}
                        <span class="status-badge status-pending">‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</span>
                    {% elif homework.is_completed %}
                        <span class="status-badge status-completed">‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
                    {% else %}
                        <span class="status-badge status-scheduled">üìã –í –ø—Ä–æ—Ü–µ—Å—Å–µ</span>
                    {% endif %}
                </div>
            </div>
            
            <div class="homework-details">
                {% if homework.due_date %}
                <p><strong>üìÖ –°—Ä–æ–∫:</strong> {{ homework.due_date.strftime('%d.%m.%Y') }}</p>
                {% endif %}
                
                {% if homework.submitted_date %}
                <p><strong>üì§ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ:</strong> {{ homework.submitted_date.strftime('%d.%m.%Y %H:%M') }}</p>
                {% endif %}
                
                {% if homework.completed_date %}
                <p><strong>‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:</strong> {{ homework.completed_date.strftime('%d.%m.%Y %H:%M') }}</p>
                {% endif %}
                
                {% if homework.student_comment %}
                <div class="student-comment">
                    <strong>üí¨ –ú–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong>
                    <p>{{ homework.student_comment }}</p>
                </div>
                {% endif %}
            </div>
            
            {% if not homework.is_confirmed_by_tutor and not homework.submitted_date %}
            <div class="homework-actions">
                <button class="btn btn-primary" onclick="showSubmitForm({{ homework.id }})">
                    üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
                </button>
            </div>
            
            <div id="submit-form-{{ homework.id }}" class="submit-form" style="display: none;">
                <form method="POST" action="{{ url_for('submit_homework_student', homework_id=homework.id) }}">
                    <div class="form-group">
                        <label for="comment-{{ homework.id }}">üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (—Å—Å—ã–ª–∫–∏, –∫–æ–¥, –∑–∞–º–µ—Ç–∫–∏)</label>
                        <textarea id="comment-{{ homework.id }}" name="student_comment" 
                                  rows="4" placeholder="–î–æ–±–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É, –∫–æ–¥ –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        <button type="button" class="btn btn-secondary" onclick="hideSubmitForm({{ homework.id }})">‚ùå –û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    {% else %}
    <div class="alert alert-info">
        üìö –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π.
    </div>
    {% endif %}
</div>

<style>
.homework-card {
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    margin-bottom: 1.5rem;
    background: white;
    overflow: hidden;
}

.homework-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background: var(--secondary-color);
    border-bottom: 1px solid var(--border-color);
}

.homework-header h3 {
    margin: 0;
    color: var(--text-primary);
}

.homework-details {
    padding: 1.5rem;
}

.homework-details p {
    margin: 0.5rem 0;
}

.student-comment {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: var(--radius-sm);
    margin-top: 1rem;
}

.student-comment p {
    margin: 0.5rem 0 0 0;
    white-space: pre-wrap;
}

.homework-actions {
    padding: 0 1.5rem 1.5rem;
}

.submit-form {
    padding: 0 1.5rem 1.5rem;
    border-top: 1px solid var(--border-color);
    background: #f8f9fa;
}

.status-pending {
    background: #ffc107;
    color: #000;
}
</style>

<script>
function showSubmitForm(homeworkId) {
    document.getElementById('submit-form-' + homeworkId).style.display = 'block';
}

function hideSubmitForm(homeworkId) {
    document.getElementById('submit-form-' + homeworkId).style.display = 'none';
}
</script>
{% endblock %}