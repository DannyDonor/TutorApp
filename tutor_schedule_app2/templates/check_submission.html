{% extends "base.html" %}

{% block title %}–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–∞–Ω–∏—è - TutorApp{% endblock %}

{% block content %}
<div class="check-header">
    <div class="breadcrumb">
        <a href="{{ url_for('tutor_submissions') }}">üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–∞–Ω–∏–π</a>
        ‚Üí
        <span>{{ submission.assignment.title }}</span>
    </div>
    
    <h1>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–∞–Ω–∏—è</h1>
</div>

<div class="submission-details">
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞–Ω–∏–∏ -->
    <div class="assignment-info">
        <h3>üìù –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞–Ω–∏–∏</h3>
        <div class="info-grid">
            <div class="info-item">
                <strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong>
                <span>{{ submission.assignment.title }}</span>
            </div>
            <div class="info-item">
                <strong>–°—Ç—É–¥–µ–Ω—Ç:</strong>
                <span>{{ submission.enrollment.student.full_name }}</span>
            </div>
            <div class="info-item">
                <strong>–ö—É—Ä—Å:</strong>
                <span>{{ submission.assignment.lesson.module.course.title }}</span>
            </div>
            <div class="info-item">
                <strong>–£—Ä–æ–∫:</strong>
                <span>{{ submission.assignment.lesson.title }}</span>
            </div>
            <div class="info-item">
                <strong>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ:</strong>
                <span>{{ submission.submitted_at.strftime('%d.%m.%Y %H:%M') }}</span>
            </div>
        </div>
        
        <div class="assignment-description">
            <strong>–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è:</strong>
            <div class="description-content">
                {{ submission.assignment.description | safe }}
            </div>
        </div>
    </div>
    
    <!-- –û—Ç–≤–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ -->
    <div class="student-answer">
        <h3>üí¨ –û—Ç–≤–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞</h3>
        <div class="answer-content">
            {{ submission.content }}
        </div>
    </div>
    
    <!-- –§–æ—Ä–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
    <div class="check-form">
        <h3>üìä –û—Ü–µ–Ω–∫–∞ –∑–∞–¥–∞–Ω–∏—è</h3>
        
        <form method="POST" class="check-form-content">
            <div class="form-group">
                <label for="points">–ë–∞–ª–ª—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
                <input type="number" 
                       id="points" 
                       name="points" 
                       class="form-control"
                       min="0" 
                       max="100"
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤">
                <div class="form-hint">–ú–∞–∫—Å–∏–º—É–º 100 –±–∞–ª–ª–æ–≤</div>
            </div>
            
            <div class="form-group">
                <label for="feedback">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞:</label>
                <textarea id="feedback" 
                          name="feedback" 
                          class="form-control"
                          rows="5"
                          placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞..."></textarea>
                <div class="form-hint">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–º–æ–∂–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç—É –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∞ —á—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å</div>
            </div>
            
            <div class="form-actions">
                <button type="submit" name="action" value="approve" class="btn btn-success btn-lg">
                    ‚úÖ –û–¥–æ–±—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                </button>
                <button type="submit" name="action" value="reject" class="btn btn-danger btn-lg"
                        onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ? –°—Ç—É–¥–µ–Ω—Ç —Å–º–æ–∂–µ—Ç –µ–≥–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å.')">
                    ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ
                </button>
                <a href="{{ url_for('tutor_submissions') }}" class="btn btn-secondary">
                    üîô –û—Ç–º–µ–Ω–∏—Ç—å
                </a>
            </div>
        </form>
    </div>
</div>

<style>
.check-header {
    margin-bottom: 2rem;
}

.breadcrumb {
    font-size: 0.9em;
    color: #666;
    margin-bottom: 1rem;
}

.breadcrumb a {
    color: var(--primary-color);
    text-decoration: none;
}

.breadcrumb a:hover {
    text-decoration: underline;
}

.check-header h1 {
    margin: 0;
    color: var(--primary-color);
}

.submission-details {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.assignment-info,
.student-answer,
.check-form {
    background: white;
    border: 1px solid #e1e5e9;
    border-radius: var(--radius);
    padding: 1.5rem;
}

.assignment-info h3,
.student-answer h3,
.check-form h3 {
    margin: 0 0 1.5rem 0;
    color: var(--primary-color);
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.info-item strong {
    color: #333;
    font-size: 0.9em;
}

.info-item span {
    color: #666;
}

.assignment-description {
    margin-top: 1.5rem;
}

.assignment-description strong {
    display: block;
    margin-bottom: 0.5rem;
    color: #333;
}

.description-content {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: var(--radius-sm);
    border-left: 3px solid #e1e5e9;
    line-height: 1.6;
}

.answer-content {
    background: #f8f9fa;
    padding: 1.5rem;
    border-radius: var(--radius-sm);
    border-left: 4px solid var(--primary-color);
    white-space: pre-wrap;
    line-height: 1.6;
    color: #333;
    min-height: 100px;
}

.check-form-content {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-group label {
    font-weight: 600;
    color: #333;
}

.form-control {
    padding: 0.75rem;
    border: 1px solid #ddd;
    border-radius: var(--radius-sm);
    font-size: 1rem;
    font-family: inherit;
}

.form-control:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
}

textarea.form-control {
    resize: vertical;
    min-height: 120px;
}

.form-hint {
    font-size: 0.85em;
    color: #666;
    font-style: italic;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-start;
    margin-top: 1rem;
}

.btn-lg {
    padding: 1rem 2rem;
    font-size: 1.1rem;
}

@media (max-width: 768px) {
    .info-grid {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }
    
    .form-actions {
        flex-direction: column;
        align-items: stretch;
    }
}
</style>

<script>
// –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ —Ñ–æ—Ä–º–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
document.addEventListener('DOMContentLoaded', function() {
    const feedbackTextarea = document.getElementById('feedback');
    if (feedbackTextarea) {
        feedbackTextarea.focus();
    }
});
</script>
{% endblock %}