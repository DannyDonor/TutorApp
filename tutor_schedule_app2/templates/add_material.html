{% extends "base.html" %}

{% block title %}–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª - {{ lesson.title }} - TutorApp{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>üìé –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª</h2>
        <div class="breadcrumb">
            <a href="{{ url_for('course_detail', course_id=course.id) }}">{{ course.title }}</a>
            ‚Üí
            <a href="{{ url_for('lesson_detail', lesson_id=lesson.id) }}">{{ lesson.title }}</a>
            ‚Üí
            <span>–ù–æ–≤—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª</span>
        </div>
    </div>
    
    <form method="POST" class="auth-form">
        <div class="form-group">
            <label for="title">üìå –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ *</label>
            <input type="text" id="title" name="title" required
                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –æ—Å–Ω–æ–≤–∞–º"
                   maxlength="200">
        </div>
        
        <div class="form-group">
            <label for="url">üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª *</label>
            <input type="url" id="url" name="url" required
                   placeholder="https://docs.google.com/presentation/d/..."
                   onchange="detectMaterialType()">
            <small class="form-text">–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –¥–æ—Å—Ç—É–ø–æ–º</small>
        </div>
        
        <div class="form-group">
            <label for="description">üìù –û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
            <textarea id="description" name="description" rows="3"
                      placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞..."></textarea>
        </div>
        
        <div class="material-type-info" id="material-type-info" style="display: none;">
            <div class="type-indicator">
                <span id="type-icon"></span>
                <span id="type-text"></span>
            </div>
            <div class="preview-note" id="preview-note"></div>
        </div>
        
        <div class="supported-services">
            <h4>üåê –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã:</h4>
            <div class="services-grid">
                <div class="service-item">
                    <div class="service-icon">üìä</div>
                    <div class="service-info">
                        <h5>Google –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏</h5>
                        <p>docs.google.com/presentation</p>
                        <small>–í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø—Ä—è–º–æ –≤ —É—Ä–æ–∫</small>
                    </div>
                </div>
                
                <div class="service-item">
                    <div class="service-icon">üìÑ</div>
                    <div class="service-info">
                        <h5>Google –î–æ–∫—É–º–µ–Ω—Ç—ã</h5>
                        <p>docs.google.com/document</p>
                        <small>–í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</small>
                    </div>
                </div>
                
                <div class="service-item">
                    <div class="service-icon">üé•</div>
                    <div class="service-info">
                        <h5>YouTube</h5>
                        <p>youtube.com / youtu.be</p>
                        <small>–í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä</small>
                    </div>
                </div>
                
                <div class="service-item">
                    <div class="service-icon">üíæ</div>
                    <div class="service-info">
                        <h5>Google –î–∏—Å–∫</h5>
                        <p>drive.google.com</p>
                        <small>–°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è</small>
                    </div>
                </div>
                
                <div class="service-item">
                    <div class="service-icon">üìã</div>
                    <div class="service-info">
                        <h5>Google –¢–∞–±–ª–∏—Ü—ã</h5>
                        <p>docs.google.com/spreadsheets</p>
                        <small>–í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</small>
                    </div>
                </div>
                
                <div class="service-item">
                    <div class="service-icon">üîó</div>
                    <div class="service-info">
                        <h5>–õ—é–±—ã–µ —Å—Å—ã–ª–∫–∏</h5>
                        <p>–õ—é–±–æ–π –≤–µ–±-—Å–∞–π—Ç</p>
                        <small>–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tips-box">
            <h4>üí° –°–æ–≤–µ—Ç—ã –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤:</h4>
            <ul>
                <li><strong>–î–ª—è Google —Å–µ—Ä–≤–∏—Å–æ–≤:</strong> –≤–∫–ª—é—á–∏—Ç–µ "–î–æ—Å—Ç—É–ø –ø–æ —Å—Å—ã–ª–∫–µ" ‚Üí "–ü—Ä–æ—Å–º–æ—Ç—Ä"</li>
                <li><strong>–î–ª—è YouTube:</strong> –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ</li>
                <li><strong>–î–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π:</strong> –¥–æ–±–∞–≤—å—Ç–µ "/embed" –≤ –∫–æ–Ω–µ—Ü —Å—Å—ã–ª–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</li>
                <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø:</strong> –æ—Ç–∫—Ä–æ–π—Ç–µ —Å—Å—ã–ª–∫—É –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ</li>
            </ul>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
            </button>
            <a href="{{ url_for('lesson_detail', lesson_id=lesson.id) }}" class="btn btn-secondary">
                ‚ùå –û—Ç–º–µ–Ω–∞
            </a>
        </div>
    </form>
</div>

<style>
.breadcrumb {
    font-size: 0.9em;
    color: #666;
    margin-top: 0.5rem;
}

.breadcrumb a {
    color: var(--primary-color);
    text-decoration: none;
}

.breadcrumb a:hover {
    text-decoration: underline;
}

.material-type-info {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: var(--radius);
    padding: 1rem;
    margin: 1rem 0;
}

.type-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: bold;
    color: var(--primary-color);
}

.type-indicator span:first-child {
    font-size: 1.5rem;
}

.preview-note {
    margin-top: 0.5rem;
    font-size: 0.9em;
    color: #666;
}

.supported-services {
    background: linear-gradient(135deg, #f8f9ff, #e8f4fd);
    border: 1px solid #c3d9ff;
    border-radius: var(--radius);
    padding: 1.5rem;
    margin: 2rem 0;
}

.supported-services h4 {
    margin: 0 0 1.5rem 0;
    color: var(--primary-color);
}

.services-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
}

.service-item {
    background: white;
    border: 1px solid #e1e5e9;
    border-radius: var(--radius-sm);
    padding: 1rem;
    display: flex;
    gap: 1rem;
    align-items: flex-start;
}

.service-icon {
    font-size: 2rem;
    flex-shrink: 0;
    margin-top: 0.25rem;
}

.service-info h5 {
    margin: 0 0 0.25rem 0;
    color: #333;
}

.service-info p {
    margin: 0 0 0.25rem 0;
    font-family: monospace;
    font-size: 0.85em;
    color: #666;
}

.service-info small {
    color: #888;
    font-style: italic;
}

.tips-box {
    background: linear-gradient(135deg, #fff4e6, #ffeaa7);
    border: 1px solid #fdcb6e;
    border-radius: var(--radius);
    padding: 1.5rem;
    margin: 2rem 0;
}

.tips-box h4 {
    margin: 0 0 1rem 0;
    color: #e17055;
}

.tips-box ul {
    margin: 0;
    padding-left: 1.5rem;
}

.tips-box li {
    margin-bottom: 0.75rem;
    line-height: 1.5;
}

.tips-box strong {
    color: #d63031;
}

.card-header h2 {
    margin: 0;
}

@media (max-width: 768px) {
    .services-grid {
        grid-template-columns: 1fr;
    }
    
    .service-item {
        flex-direction: column;
        text-align: center;
    }
}
</style>

<script>
function detectMaterialType() {
    const urlInput = document.getElementById('url');
    const typeInfo = document.getElementById('material-type-info');
    const typeIcon = document.getElementById('type-icon');
    const typeText = document.getElementById('type-text');
    const previewNote = document.getElementById('preview-note');
    
    const url = urlInput.value.toLowerCase();
    
    if (!url) {
        typeInfo.style.display = 'none';
        return;
    }
    
    let icon = '', text = '', note = '';
    
    if (url.includes('docs.google.com/presentation')) {
        icon = 'üìä';
        text = 'Google –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è';
        note = '–ë—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä—è–º–æ –≤ —É—Ä–æ–∫ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞';
    } else if (url.includes('docs.google.com/document')) {
        icon = 'üìÑ';
        text = 'Google –î–æ–∫—É–º–µ–Ω—Ç';
        note = '–ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ —É—Ä–æ–∫–µ';
    } else if (url.includes('docs.google.com/spreadsheets')) {
        icon = 'üìã';
        text = 'Google –¢–∞–±–ª–∏—Ü–∞';
        note = '–ë—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö';
    } else if (url.includes('drive.google.com')) {
        icon = 'üíæ';
        text = '–§–∞–π–ª Google –î–∏—Å–∫';
        note = '–°—Ç—É–¥–µ–Ω—Ç—ã —Å–º–æ–≥—É—Ç –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ';
    } else if (url.includes('youtube.com') || url.includes('youtu.be')) {
        icon = 'üé•';
        text = 'YouTube –≤–∏–¥–µ–æ';
        note = '–í–∏–¥–µ–æ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä—è–º–æ –≤ —É—Ä–æ–∫';
    } else if (url.includes('vimeo.com')) {
        icon = 'üé•';
        text = 'Vimeo –≤–∏–¥–µ–æ';
        note = '–í–∏–¥–µ–æ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–æ –≤ —É—Ä–æ–∫';
    } else if (url.includes('.pdf')) {
        icon = 'üìÑ';
        text = 'PDF –¥–æ–∫—É–º–µ–Ω—Ç';
        note = '–û—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞';
    } else if (url.includes('.jpg') || url.includes('.png') || url.includes('.gif')) {
        icon = 'üì∏';
        text = '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ';
        note = '–ë—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ –ø—Ä—è–º–æ –≤ —É—Ä–æ–∫–µ';
    } else {
        icon = 'üîó';
        text = '–í–µ–±-—Å—Å—ã–ª–∫–∞';
        note = '–û—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞';
    }
    
    typeIcon.textContent = icon;
    typeText.textContent = text;
    previewNote.textContent = note;
    typeInfo.style.display = 'block';
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    detectMaterialType();
});
</script>
{% endblock %}